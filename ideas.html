<input type="text" id="framesmade" value="0" style="display:none;" />
<div id=thumbs>Loading video in background...</div>
<script>
var i = 0;
var video = document.createElement("video");
var thumbs = document.getElementById("thumbs");

video.addEventListener('loadeddata', function() {
	thumbs.innerHTML = "";
    video.currentTime = i;
}, false);

video.addEventListener('seeked', function() {
    // now video has seeked and current frames will show
    // at the time as we expect
    generateThumbnail(i);

    // when frame is captured, increase
    i += 0.02;

    // if we are not passed end, seek to next interval
    if (i <= video.duration) {
        // this will trigger another seeked event
        video.currentTime = i;
    }
	else {
		console.log("done!")
    }

}, false);

video.preload = "auto"
video.src = "https://media.w3.org/2010/05/sintel/trailer.mp4";
var cs = document.createElement("canvas");
cs.id = "loadbar"
cs.style = "position:absolute; top: 50%; left: 50%; transform:translate(-50%,-50%); border: 1px solid; border-radius: 15px;"
cs.width = window.innerWidth/2;
cs.height = "30";
document.body.appendChild(cs);

function generateThumbnail() {
  var frames = parseInt(document.getElementById("framesmade").value);
  var c = document.createElement("canvas");
  var ctx = c.getContext("2d");
  c.width = video.videoWidth;
  c.height = video.videoHeight;
  c.id = "vid"+frames;
  c.style = "display:none;"
  ctx.drawImage(video, 0, 0, c.width, c.height);
  thumbs.appendChild(c);
  document.getElementById("framesmade").value = frames + 1;
  var cs = document.getElementById("loadbar");
  var percent = Math.round(((frames/50)/(video.duration))*100);
  var filled = (percent/100)*cs.width;
  var ctxi = cs.getContext("2d");
  ctxi.fillStyle="lightblue";
  ctxi.fillRect(0,0,filled,30);
  ctxi.fillStyle="#9BC2CF";
  ctxi.fillRect(filled,0,2,30);
}
</script>
